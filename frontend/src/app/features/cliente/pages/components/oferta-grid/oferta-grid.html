<div class="oferta-grid-container">
    <div *ngIf="loading" class="loading-spinner">
        <i class="fas fa-spinner fa-spin fa-3x"></i>
        <p>Cargando ofertas...</p>
    </div>

    <div *ngIf="errorMessage" class="error-message">
        <i class="fas fa-exclamation-triangle"></i> {{ errorMessage }}
    </div>

    <div *ngIf="!loading && !errorMessage">
        <div *ngIf="ofertas.length === 0" class="no-data-message">
            <p><i class="fas fa-info-circle"></i> {{ emptyMessage || 'No hay ofertas disponibles en este momento.' }}</p>
        </div>

        <div *ngIf="ofertas.length > 0" class="ofertas-grid">
            <div *ngFor="let oferta of ofertas" class="oferta-card">
                <div class="oferta-header">
                    <div class="oferta-badge">
                        <span class="discount-percentage">{{ oferta.porcentajeDescuento }}%</span>
                        <span class="discount-text">DESCUENTO</span>
                    </div>
                </div>
                
                <div class="oferta-content">
                    <h3 class="oferta-title">{{ oferta.nombre }}</h3>
                    <p *ngIf="oferta.descripcion" class="oferta-description">{{ oferta.descripcion }}</p>
                    
                    <div class="oferta-type">
                        <span class="type-icon">{{ getTipoOfertaIcon(oferta.tipoOferta) }}</span>
                        <span class="type-text">{{ getTipoOfertaText(oferta.tipoOferta) }}</span>
                    </div>
                    
                    <div class="oferta-applicables">
                        <div *ngIf="oferta.tipoOferta === 'producto' && oferta.productosAplicables && oferta.productosAplicables.length > 0">
                            <strong>Aplica a:</strong>
                            <div class="applicables-list">
                                <span *ngFor="let prod of oferta.productosAplicables.slice(0, 3); let last = last">
                                    {{ prod.nombre }}<span *ngIf="!last">, </span>
                                </span>
                                <span *ngIf="oferta.productosAplicables.length > 3" class="more-items">
                                    +{{ oferta.productosAplicables.length - 3 }} más
                                </span>
                            </div>
                        </div>
                        
                        <div *ngIf="oferta.tipoOferta === 'categoria' && oferta.categoriasAplicables && oferta.categoriasAplicables.length > 0">
                            <strong>Aplica a categorías:</strong>
                            <div class="applicables-list">
                                <span *ngFor="let cat of oferta.categoriasAplicables.slice(0, 3); let last = last">
                                    {{ cat.nombre }}<span *ngIf="!last">, </span>
                                </span>
                                <span *ngIf="oferta.categoriasAplicables.length > 3" class="more-items">
                                    +{{ oferta.categoriasAplicables.length - 3 }} más
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="oferta-dates">
                        <div class="date-info">
                            <small><strong>Válida desde:</strong> {{ formatDateForDisplay(oferta.fechaInicio) }}</small>
                            <small><strong>Hasta:</strong> {{ formatDateForDisplay(oferta.fechaFin) }}</small>
                        </div>
                    </div>
                    
                    <div class="oferta-status">
                        <span *ngIf="isOfertaVigente(oferta)" class="status-vigente">
                            <i class="fas fa-check-circle"></i> Vigente
                        </span>
                        <span *ngIf="!isOfertaVigente(oferta)" class="status-no-vigente">
                            <i class="fas fa-clock"></i> No vigente
                        </span>
                    </div>
                    
                    <button class="view-details-btn" (click)="viewOfertaDetails(oferta._id!)">
                        <i class="fas fa-eye"></i> Ver Detalles
                    </button>
                </div>
            </div>
        </div>
    </div>
</div> 