<div class="manage-clientes-container">
  <h2>Gestión de Clientes</h2>
  <p>Lista de clientes registrados en el sistema.</p>

  <div class="action-buttons">
    <!-- El botón para añadir cliente lleva al formulario de creación adaptable -->
    <a routerLink="/admin/users/create" class="btn btn-primary">
      <i class="fas fa-user-plus"></i> Añadir Nuevo Cliente
    </a>
    <button (click)="loadClientes()" class="btn btn-secondary">
      <i class="fas fa-sync-alt"></i> Actualizar Lista
    </button>
  </div>

  <div *ngIf="isLoading" class="loading-spinner">
    <i class="fas fa-spinner fa-spin"></i> Cargando clientes...
  </div>

  <div *ngIf="errorMessage" class="error-message">
    <i class="fas fa-exclamation-triangle"></i> {{ errorMessage }}
  </div>

  <div *ngIf="!isLoading && clientes.length === 0 && !errorMessage" class="no-data-message">
    <i class="fas fa-info-circle"></i> No hay clientes registrados en el sistema.
  </div>

  <div *ngIf="!isLoading && clientes.length > 0" class="table-responsive">
    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>Nombre Completo</th>
          <th>Email</th>
          <th>Teléfono</th>
          <th>Dirección</th>
          <th>Puntos</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cliente of clientes">
          <td>{{ cliente.username }}</td>
          <td>{{ cliente.nombre }} {{ cliente.apellido }}</td>
          <td>{{ cliente.email }}</td>
          <td>{{ cliente.telefono || 'N/A' }}</td>
          <!-- Accede a las propiedades del perfil de cliente a través de cliente.clienteId -->
          <td>{{ cliente.clienteId?.direccion || 'N/A' }}</td>
          <td>{{ cliente.clienteId?.puntos || 0 }}</td>
          <td>
            <button (click)="editCliente(cliente._id)" class="btn btn-edit" title="Editar">
              <i class="fas fa-edit"></i>
            </button>
            <button (click)="deleteCliente(cliente._id, cliente.username)" class="btn btn-delete" title="Eliminar">
              <i class="fas fa-trash-alt"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="back-link">
    <a routerLink="/admin/users/manage-by-role"><i class="fas fa-arrow-left"></i> Volver a Gestión por Rol</a>
  </div>
</div>